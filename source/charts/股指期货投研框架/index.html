<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‚¡æŒ‡æœŸè´§æŠ•ç ”æ¡†æ¶ | Stock Index Futures Research Framework</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans SC', sans-serif; }
        .chart-container { 
            position: relative; 
            width: 100%; 
            max-width: 100%; 
            height: 350px; 
            max-height: 400px; 
        }
        @media (min-width: 768px) {
            .chart-container { height: 400px; }
        }
        .nav-item.active {
            color: #2563eb; /* blue-600 */
            border-bottom-color: #2563eb;
        }
        .slider-thumb::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: #2563eb;
            cursor: pointer;
            border-radius: 50%;
        }
    </style>
    <!-- Chosen Palette: Financial Blue & Slate. Background: Slate-50. Text: Slate-900. Accents: Blue-600 (Growth/Long), Red-600 (Risk/Short). -->
    <!-- Application Structure Plan:
         1. Header: Title and Ticker selection (IF/IH/IC/IM context).
         2. Macro Logic (DDM): The core theoretical framework. Interactive DDM formula.
         3. Valuation & Flows: PE/PB bands and Capital Flows (Northbound).
         4. Basis & Arbitrage: Understanding the spread between Futures and Spot.
         5. Footer: Risk Disclaimer.
         Reasoning: Financial analysis moves from Macro (Theory) -> Meso (Valuation) -> Micro (Basis/Trading). -->
    <!-- Visualization & Content Choices:
         - DDM Simulator: HTML Inputs + JS Logic. Goal: Visualize P = E / (r-g).
         - Valuation Chart: Chart.js Combo Chart. Goal: Show Price vs PE.
         - Basis Calculator: JS Input/Output. Goal: Calculate annualized basis yield.
         - Style Matrix: HTML Grid. Goal: Differentiate the 4 futures contracts.
         - NO SVG/Mermaid. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="bg-slate-50 text-slate-800">

    <!-- Header -->
    <header class="bg-white border-b border-slate-200 sticky top-0 z-50">
        <div class="container mx-auto px-4 py-4 flex flex-col md:flex-row justify-between items-center">
            <div class="flex items-center gap-3 mb-4 md:mb-0">
                <div class="w-10 h-10 bg-blue-700 rounded text-white flex items-center justify-center font-bold text-xl">IF</div>
                <div>
                    <h1 class="text-xl font-bold text-slate-900">è‚¡æŒ‡æœŸè´§æŠ•ç ”æ¡†æ¶</h1>
                    <p class="text-xs text-slate-500">Stock Index Futures Research Dashboard</p>
                </div>
            </div>
            
            <!-- Navigation Tabs -->
            <nav class="flex space-x-6 text-sm font-medium border-b border-transparent md:border-none w-full md:w-auto overflow-x-auto">
                <button onclick="switchTab('macro')" id="nav-macro" class="nav-item active px-2 py-2 border-b-2 border-blue-600 text-blue-600 whitespace-nowrap transition-colors">å®šä»·é€»è¾‘ (DDM)</button>
                <button onclick="switchTab('valuation')" id="nav-valuation" class="nav-item px-2 py-2 border-b-2 border-transparent text-slate-500 hover:text-blue-600 whitespace-nowrap transition-colors">ä¼°å€¼ä¸èµ„é‡‘</button>
                <button onclick="switchTab('basis')" id="nav-basis" class="nav-item px-2 py-2 border-b-2 border-transparent text-slate-500 hover:text-blue-600 whitespace-nowrap transition-colors">åŸºå·®ä¸å¥—åˆ©</button>
                <button onclick="switchTab('style')" id="nav-style" class="nav-item px-2 py-2 border-b-2 border-transparent text-slate-500 hover:text-blue-600 whitespace-nowrap transition-colors">å“ç§å¯¹æ¯”</button>
            </nav>
        </div>
    </header>

    <main class="container mx-auto px-4 py-8 pb-20">

        <!-- VIEW 1: MACRO / DDM (å®è§‚å®šä»·) -->
        <div id="view-macro" class="view-section animate-fade-in">
            <!-- Context Header -->
            <div class="mb-8 text-center max-w-3xl mx-auto">
                <h2 class="text-2xl font-bold text-slate-800 mb-2">æ ¸å¿ƒå®šä»·æ¨¡å‹ï¼šåˆ†å­ä¸åˆ†æ¯çš„åšå¼ˆ</h2>
                <p class="text-slate-600 text-sm">
                    è‚¡æŒ‡èµ°åŠ¿é•¿æœŸéµå¾ª <strong>DDM (è‚¡åˆ©è´´ç°æ¨¡å‹)</strong>ã€‚
                    <span class="text-red-600 font-bold">åˆ†å­ç«¯</span>ä»£è¡¨ä¼ä¸šç›ˆåˆ©ï¼ˆç»æµå¢é•¿ï¼‰ï¼Œ
                    <span class="text-blue-600 font-bold">åˆ†æ¯ç«¯</span>ä»£è¡¨æ— é£é™©åˆ©ç‡ä¸é£é™©åå¥½ï¼ˆæµåŠ¨æ€§ï¼‰ã€‚
                </p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
                <!-- Interactive Formula Card -->
                <div class="lg:col-span-5 bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                    <div class="text-center mb-6 p-4 bg-slate-50 rounded-lg border border-slate-200">
                        <div class="text-xs text-slate-500 uppercase tracking-wide mb-2">Fair Value Formula</div>
                        <div class="text-3xl font-serif italic text-slate-800">
                            P = <span class="text-red-500 border-b-2 border-red-200">EPS Ã— (1+g)</span> / <span class="text-blue-500 border-b-2 border-blue-200">(r - g)</span>
                        </div>
                    </div>

                    <div class="space-y-6">
                        <!-- Numerator Control -->
                        <div>
                            <div class="flex justify-between mb-2">
                                <label class="font-bold text-red-600 text-sm flex items-center">
                                    <span class="mr-2">ğŸ“ˆ</span> ç›ˆåˆ©å¢é€Ÿ (g) / EPS Growth
                                </label>
                                <span id="val-g" class="font-mono font-bold text-slate-700">5.0%</span>
                            </div>
                            <input type="range" id="input-g" min="0" max="15" step="0.5" value="5" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer" oninput="updateDDM()">
                            <p class="text-xs text-slate-400 mt-1">é©±åŠ¨å› å­ï¼šGDPå¢é€Ÿ, PPI, ä¼ä¸šåˆ©æ¶¦</p>
                        </div>

                        <!-- Denominator Control -->
                        <div>
                            <div class="flex justify-between mb-2">
                                <label class="font-bold text-blue-600 text-sm flex items-center">
                                    <span class="mr-2">ğŸ¦</span> æ— é£é™©åˆ©ç‡ (r) / 10Y Yield
                                </label>
                                <span id="val-r" class="font-mono font-bold text-slate-700">2.8%</span>
                            </div>
                            <input type="range" id="input-r" min="1.5" max="6" step="0.1" value="2.8" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer" oninput="updateDDM()">
                            <p class="text-xs text-slate-400 mt-1">é©±åŠ¨å› å­ï¼šMLF, LPR, å›½å€ºæ”¶ç›Šç‡, è´§å¸æ”¿ç­–</p>
                        </div>

                        <!-- Risk Premium Control -->
                        <div>
                            <div class="flex justify-between mb-2">
                                <label class="font-bold text-purple-600 text-sm flex items-center">
                                    <span class="mr-2">â¤ï¸â€ğŸ”¥</span> é£é™©æº¢ä»· (ERP) / Sentiment
                                </label>
                                <span id="val-erp" class="font-mono font-bold text-slate-700">4.0%</span>
                            </div>
                            <input type="range" id="input-erp" min="2" max="8" step="0.1" value="4" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer" oninput="updateDDM()">
                            <p class="text-xs text-slate-400 mt-1">é©±åŠ¨å› å­ï¼šåœ°ç¼˜æ”¿æ²», æ”¿ç­–ç›‘ç®¡, å¸‚åœºæƒ…ç»ª</p>
                        </div>
                    </div>
                </div>

                <!-- Simulation Output -->
                <div class="lg:col-span-7 flex flex-col justify-center">
                    <div class="bg-gradient-to-br from-slate-800 to-slate-900 text-white p-8 rounded-xl shadow-lg relative overflow-hidden">
                        <!-- Decorative bg elements -->
                        <div class="absolute top-0 right-0 w-32 h-32 bg-white opacity-5 rounded-full -mr-16 -mt-16"></div>
                        
                        <h3 class="text-slate-300 text-sm uppercase tracking-widest mb-2">Implied Index Level</h3>
                        <div class="flex items-baseline gap-4">
                            <span id="result-price" class="text-6xl font-bold text-white transition-all duration-300">3500</span>
                            <span id="result-change" class="text-lg font-medium text-green-400">+0.0%</span>
                        </div>
                        <div class="mt-6 pt-6 border-t border-slate-700 grid grid-cols-2 gap-4">
                            <div>
                                <div class="text-xs text-slate-400 mb-1">å½“å‰æƒ…æ™¯è§£è¯»</div>
                                <div id="scenario-text" class="text-sm font-medium text-blue-200">
                                    ä¸­æ€§ç¯å¢ƒï¼šç›ˆåˆ©æ¸©å’Œå¢é•¿ï¼ŒæµåŠ¨æ€§åˆç†å……è£•ã€‚
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="text-xs text-slate-400 mb-1">ç†è®ºå¸‚ç›ˆç‡ (PE)</div>
                                <div id="result-pe" class="text-xl font-mono text-white">14.7x</div>
                            </div>
                        </div>
                    </div>

                    <div class="mt-6 grid grid-cols-2 gap-4">
                        <div class="p-4 bg-white rounded-lg border border-slate-200 shadow-sm">
                            <h4 class="font-bold text-slate-700 text-sm mb-2">åˆ©å¥½ç¯å¢ƒ (Bull Case)</h4>
                            <ul class="text-xs text-slate-600 space-y-1">
                                <li>â€¢ å®½ä¿¡ç”¨ (ç¤¾èâ†‘)</li>
                                <li>â€¢ ç»æµå¤è‹ (PMI > 50)</li>
                                <li>â€¢ åˆ©ç‡ä¸‹è¡Œ (é™æ¯)</li>
                            </ul>
                        </div>
                        <div class="p-4 bg-white rounded-lg border border-slate-200 shadow-sm">
                            <h4 class="font-bold text-slate-700 text-sm mb-2">åˆ©ç©ºç¯å¢ƒ (Bear Case)</h4>
                            <ul class="text-xs text-slate-600 space-y-1">
                                <li>â€¢ ç´§è´§å¸ (åŠ æ¯/å›ç¬¼)</li>
                                <li>â€¢ æ»èƒ€ (é€šèƒ€â†‘ å¢é•¿â†“)</li>
                                <li>â€¢ å¤–éƒ¨å†²å‡» (æ±‡ç‡è´¬å€¼)</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- VIEW 2: VALUATION (ä¼°å€¼) -->
        <div id="view-valuation" class="view-section hidden">
            <div class="mb-6 flex justify-between items-end">
                <div>
                    <h3 class="text-xl font-bold text-slate-800">ä¼°å€¼æ°´ä½ä¸èµ„é‡‘æµå‘</h3>
                    <p class="text-slate-500 text-sm">åˆ¤æ–­æŒ‡æ•°æ˜¯"ä¾¿å®œ"è¿˜æ˜¯"è´µ"ï¼Œå¹¶è·Ÿè¸ª"èªæ˜é’±"ï¼ˆåŒ—å‘èµ„é‡‘ï¼‰çš„åŠ¨å‘ã€‚</p>
                </div>
                <div class="flex gap-2">
                    <button class="px-3 py-1 bg-blue-100 text-blue-700 text-xs rounded-full font-bold">IF (æ²ªæ·±300)</button>
                    <button class="px-3 py-1 bg-slate-100 text-slate-600 text-xs rounded-full hover:bg-slate-200">IC (ä¸­è¯500)</button>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Main Chart -->
                <div class="lg:col-span-2 bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                    <h4 class="font-bold text-slate-700 mb-4 text-sm">æŒ‡æ•°èµ°åŠ¿ vs åŒ—å‘èµ„é‡‘ç´¯è®¡å‡€ä¹°å…¥ (äº¿å…ƒ)</h4>
                    <div class="chart-container">
                        <canvas id="valuationChart"></canvas>
                    </div>
                </div>

                <!-- Valuation Indicators -->
                <div class="space-y-6">
                    <!-- PE Gauge Logic (Simplified as Bar) -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                        <h4 class="font-bold text-slate-700 mb-4 text-sm">å½“å‰ PE-TTM åˆ†ä½ç‚¹</h4>
                        <div class="relative pt-6 pb-2">
                            <div class="h-4 bg-gradient-to-r from-green-400 via-yellow-400 to-red-500 rounded-full w-full"></div>
                            <!-- Marker -->
                            <div class="absolute top-4 left-[30%] -ml-1 flex flex-col items-center">
                                <div class="w-0 h-0 border-l-[6px] border-l-transparent border-r-[6px] border-r-transparent border-t-[8px] border-t-slate-800"></div>
                                <span class="text-xs font-bold text-slate-800 mt-1">30% (ä½ä¼°)</span>
                            </div>
                        </div>
                        <div class="flex justify-between text-xs text-slate-400 mt-2">
                            <span>å†å²æä½</span>
                            <span>ä¸­ä½æ•°</span>
                            <span>å†å²æé«˜</span>
                        </div>
                        <div class="mt-4 text-sm text-slate-600 bg-slate-50 p-3 rounded">
                            <p>å½“å‰PE: <span class="font-mono font-bold text-slate-900">11.2x</span></p>
                            <p>æœºä¼šå€¼: < 10x</p>
                            <p>å±é™©å€¼: > 16x</p>
                        </div>
                    </div>

                    <!-- Market Width -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                        <h4 class="font-bold text-slate-700 mb-2 text-sm">å¸‚åœºæ‹¥æŒ¤åº¦æŒ‡æ ‡</h4>
                        <div class="space-y-3">
                            <div>
                                <div class="flex justify-between text-xs mb-1">
                                    <span class="text-slate-600">æˆäº¤é¢å æ¯” (å‰10%)</span>
                                    <span class="text-red-500 font-bold">42% (æ‹¥æŒ¤)</span>
                                </div>
                                <div class="w-full bg-slate-100 rounded-full h-2">
                                    <div class="bg-red-500 h-2 rounded-full" style="width: 80%"></div>
                                </div>
                            </div>
                            <div>
                                <div class="flex justify-between text-xs mb-1">
                                    <span class="text-slate-600">æ¢æ‰‹ç‡åˆ†ä½</span>
                                    <span class="text-blue-500 font-bold">25% (å†·æ¸…)</span>
                                </div>
                                <div class="w-full bg-slate-100 rounded-full h-2">
                                    <div class="bg-blue-500 h-2 rounded-full" style="width: 25%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- VIEW 3: BASIS (åŸºå·®) -->
        <div id="view-basis" class="view-section hidden">
            <div class="max-w-4xl mx-auto">
                <div class="mb-8 text-center">
                    <h3 class="text-xl font-bold text-slate-800">åŸºå·® (Basis) ä¸ æœŸç°å¥—åˆ©</h3>
                    <p class="text-slate-500 text-sm">åŸºå·® = ç°è´§ä»·æ ¼ - æœŸè´§ä»·æ ¼ã€‚æ·±åˆ»ç†è§£å‡è´´æ°´ç»“æ„æ˜¯è·å¾—Alphaæ”¶ç›Šçš„å…³é”®ã€‚</p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                    <!-- Concept Card 1 -->
                    <div class="bg-white p-6 rounded-xl shadow border-t-4 border-green-500">
                        <h4 class="font-bold text-slate-800 mb-2">è´´æ°´ç»“æ„ (Backwardation)</h4>
                        <div class="text-sm text-slate-600 mb-4">
                            <span class="font-bold text-green-600">æœŸè´§ price < ç°è´§ price</span> (åŸºå·® > 0)ã€‚
                            å¸¸è§äºIC(ä¸­è¯500)å’ŒIM(ä¸­è¯1000)ã€‚
                        </div>
                        <ul class="text-xs text-slate-500 list-disc list-inside space-y-1">
                            <li>æˆå› ï¼šå¯¹å†²éœ€æ±‚å¼ºçƒˆï¼Œç©ºå¤´æ„¿æ„æ”¯ä»˜"ä¿é™©è´¹"ã€‚</li>
                            <li>ç­–ç•¥ï¼š<strong>å¤šå¤´æ»šè´´æ°´</strong>ã€‚é•¿æœŸæŒæœ‰æœŸè´§å¤šå¤´ï¼Œèµšå–åŸºå·®æ”¶æ•›çš„æ”¶ç›Šã€‚</li>
                        </ul>
                    </div>
                    
                    <!-- Concept Card 2 -->
                    <div class="bg-white p-6 rounded-xl shadow border-t-4 border-red-500">
                        <h4 class="font-bold text-slate-800 mb-2">å‡æ°´ç»“æ„ (Contango)</h4>
                        <div class="text-sm text-slate-600 mb-4">
                            <span class="font-bold text-red-600">æœŸè´§ price > ç°è´§ price</span> (åŸºå·® < 0)ã€‚
                            å¸¸è§äºå¤§ç‰›å¸‚ä¸­çš„IF/IHã€‚
                        </div>
                        <ul class="text-xs text-slate-500 list-disc list-inside space-y-1">
                            <li>æˆå› ï¼šåšå¤šæƒ…ç»ªé«˜æ¶¨ï¼Œèµ„é‡‘ä¹°å…¥æœŸè´§åŠ æ æ†ã€‚</li>
                            <li>ç­–ç•¥ï¼š<strong>æœŸç°æ­£å¥—</strong>ã€‚ä¹°å…¥ç°è´§ï¼Œå–å‡ºæœŸè´§ï¼Œé”å®šæ— é£é™©ä»·å·®ã€‚</li>
                        </ul>
                    </div>
                </div>

                <!-- Calculator -->
                <div class="bg-slate-800 text-white rounded-xl p-6 shadow-lg">
                    <h4 class="font-bold text-blue-300 mb-4 flex items-center">
                        <span class="text-xl mr-2">ğŸ§®</span> å¹´åŒ–åŸºå·®æ”¶ç›Šç‡è®¡ç®—å™¨
                    </h4>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div>
                            <label class="block text-xs text-slate-400 mb-1">ç°è´§æŒ‡æ•°ç‚¹ä½ (Spot)</label>
                            <input type="number" id="calc-spot" value="3800" class="w-full bg-slate-700 border border-slate-600 rounded px-3 py-2 text-white focus:outline-none focus:border-blue-500" oninput="calcBasis()">
                        </div>
                        <div>
                            <label class="block text-xs text-slate-400 mb-1">æœŸè´§åˆçº¦ç‚¹ä½ (Futures)</label>
                            <input type="number" id="calc-fut" value="3750" class="w-full bg-slate-700 border border-slate-600 rounded px-3 py-2 text-white focus:outline-none focus:border-blue-500" oninput="calcBasis()">
                        </div>
                        <div>
                            <label class="block text-xs text-slate-400 mb-1">å‰©ä½™å¤©æ•° (Days)</label>
                            <input type="number" id="calc-days" value="20" class="w-full bg-slate-700 border border-slate-600 rounded px-3 py-2 text-white focus:outline-none focus:border-blue-500" oninput="calcBasis()">
                        </div>
                    </div>

                    <div class="mt-6 pt-4 border-t border-slate-700 flex justify-between items-center">
                        <div>
                            <div class="text-xs text-slate-400">å½“å‰åŸºå·® (Points)</div>
                            <div id="res-basis-abs" class="text-xl font-bold text-green-400">+50.00</div>
                        </div>
                        <div class="text-right">
                            <div class="text-xs text-slate-400">å¹´åŒ–åŸºå·®ç‡ (Annualized Yield)</div>
                            <div id="res-basis-ann" class="text-3xl font-bold text-white">24.01%</div>
                        </div>
                    </div>
                    <p class="text-xs text-slate-500 mt-2 italic">*è‹¥åšå¤šè´´æ°´åˆçº¦æŒæœ‰è‡³åˆ°æœŸï¼Œç†è®ºå¹´åŒ–æ”¶ç›Šå‚è€ƒæ­¤å€¼ã€‚</p>
                </div>
            </div>
        </div>

        <!-- VIEW 4: STYLE (é£æ ¼å¯¹æ¯”) -->
        <div id="view-style" class="view-section hidden">
            <div class="mb-6">
                <h3 class="text-xl font-bold text-slate-800">å››å¤§æœŸæŒ‡å“ç§ç‰¹å¾çŸ©é˜µ</h3>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- IH -->
                <div class="bg-white p-5 rounded-lg border border-slate-200 hover:shadow-md transition-shadow">
                    <div class="flex justify-between items-start mb-3">
                        <div class="bg-blue-100 text-blue-800 font-bold px-2 py-1 rounded text-lg">IH</div>
                        <div class="text-xs text-slate-500">ä¸Šè¯50 / SSE 50</div>
                    </div>
                    <h4 class="font-bold text-slate-800 text-sm mb-2">è¶…çº§è“ç­¹ / ä»·å€¼é˜²å¾¡</h4>
                    <p class="text-xs text-slate-600 mb-3">é‡‘èåœ°äº§ã€é£Ÿå“é¥®æ–™å æ¯”æé«˜ã€‚ä¸»è¦å—å®è§‚ç»æµæ€»é‡æŒ‡æ ‡å½±å“ã€‚</p>
                    <div class="flex gap-2">
                        <span class="text-[10px] bg-slate-100 px-2 py-1 rounded text-slate-600">é«˜åˆ†çº¢</span>
                        <span class="text-[10px] bg-slate-100 px-2 py-1 rounded text-slate-600">ä½æ³¢åŠ¨</span>
                    </div>
                </div>

                <!-- IF -->
                <div class="bg-white p-5 rounded-lg border border-slate-200 hover:shadow-md transition-shadow">
                    <div class="flex justify-between items-start mb-3">
                        <div class="bg-indigo-100 text-indigo-800 font-bold px-2 py-1 rounded text-lg">IF</div>
                        <div class="text-xs text-slate-500">æ²ªæ·±300 / CSI 300</div>
                    </div>
                    <h4 class="font-bold text-slate-800 text-sm mb-2">æ ¸å¿ƒèµ„äº§ / å¸‚åœºæ ‡æ†</h4>
                    <p class="text-xs text-slate-600 mb-3">ä»£è¡¨ä¸­å›½ç»æµæ ¸å¿ƒèµ„äº§ã€‚è¡Œä¸šåˆ†å¸ƒå‡è¡¡ï¼Œæœºæ„æŒä»“æœ€é‡ã€‚</p>
                    <div class="flex gap-2">
                        <span class="text-[10px] bg-slate-100 px-2 py-1 rounded text-slate-600">è¡Œä¸šé¾™å¤´</span>
                        <span class="text-[10px] bg-slate-100 px-2 py-1 rounded text-slate-600">å¤–èµ„é¦–é€‰</span>
                    </div>
                </div>

                <!-- IC -->
                <div class="bg-white p-5 rounded-lg border border-slate-200 hover:shadow-md transition-shadow">
                    <div class="flex justify-between items-start mb-3">
                        <div class="bg-orange-100 text-orange-800 font-bold px-2 py-1 rounded text-lg">IC</div>
                        <div class="text-xs text-slate-500">ä¸­è¯500 / CSI 500</div>
                    </div>
                    <h4 class="font-bold text-slate-800 text-sm mb-2">ä¸­ç›˜æˆé•¿ / ç»†åˆ†é¾™å¤´</h4>
                    <p class="text-xs text-slate-600 mb-3">åŒ»è¯ç”Ÿç‰©ã€ç”µå­ã€åŸºç¡€åŒ–å·¥å æ¯”è¾ƒé«˜ã€‚å¯¹æµåŠ¨æ€§å’Œäº§ä¸šæ”¿ç­–æ•æ„Ÿã€‚</p>
                    <div class="flex gap-2">
                        <span class="text-[10px] bg-slate-100 px-2 py-1 rounded text-slate-600">é«˜å¼¹æ€§</span>
                        <span class="text-[10px] bg-slate-100 px-2 py-1 rounded text-slate-600">å¸¸å¹´è´´æ°´</span>
                    </div>
                </div>

                <!-- IM -->
                <div class="bg-white p-5 rounded-lg border border-slate-200 hover:shadow-md transition-shadow">
                    <div class="flex justify-between items-start mb-3">
                        <div class="bg-purple-100 text-purple-800 font-bold px-2 py-1 rounded text-lg">IM</div>
                        <div class="text-xs text-slate-500">ä¸­è¯1000 / CSI 1000</div>
                    </div>
                    <h4 class="font-bold text-slate-800 text-sm mb-2">å°ç›˜æ´»è·ƒ / ä¸“ç²¾ç‰¹æ–°</h4>
                    <p class="text-xs text-slate-600 mb-3">å¸‚å€¼å°ï¼Œæ³¢åŠ¨å¤§ï¼Œé‡åŒ–èµ„é‡‘æœ€æ´»è·ƒçš„æˆ˜åœºã€‚è¶…é¢æ”¶ç›Šè·å–éš¾åº¦ä½ã€‚</p>
                    <div class="flex gap-2">
                        <span class="text-[10px] bg-slate-100 px-2 py-1 rounded text-slate-600">é«˜æ³¢åŠ¨</span>
                        <span class="text-[10px] bg-slate-100 px-2 py-1 rounded text-slate-600">é‡åŒ–å¢å¼º</span>
                    </div>
                </div>
            </div>
            
            <div class="mt-8 p-6 bg-white rounded-xl border border-slate-200">
                <h4 class="font-bold text-slate-700 mb-4">å¤§å°ç›˜è½®åŠ¨é€»è¾‘å›¾è°±</h4>
                <div class="flex justify-between items-center text-xs text-slate-500">
                    <div class="text-center w-1/3">
                        <div class="font-bold text-blue-600 mb-2">å®½ä¿¡ç”¨åˆæœŸ</div>
                        <div class="bg-slate-100 p-2 rounded">åˆ©å¥½å¤§ç›˜ (IH/IF)</div>
                        <div class="mt-1">åŸºå»º/åœ°äº§ä¿®å¤</div>
                    </div>
                    <div class="text-xl text-slate-300">â†’</div>
                    <div class="text-center w-1/3">
                        <div class="font-bold text-orange-600 mb-2">å®½æµåŠ¨æ€§/å¤è‹</div>
                        <div class="bg-slate-100 p-2 rounded">åˆ©å¥½ä¸­å°ç›˜ (IC/IM)</div>
                        <div class="mt-1">ç§‘æŠ€/åˆ¶é€ çˆ†å‘</div>
                    </div>
                    <div class="text-xl text-slate-300">â†’</div>
                    <div class="text-center w-1/3">
                        <div class="font-bold text-red-600 mb-2">è¡°é€€/æ»èƒ€</div>
                        <div class="bg-slate-100 p-2 rounded">é˜²å®ˆé…ç½® (IH)</div>
                        <div class="mt-1">é«˜è‚¡æ¯/ä½ä¼°å€¼</div>
                    </div>
                </div>
            </div>
        </div>

    </main>

    <script>
        // --- Tab Switching Logic ---
        const tabs = ['macro', 'valuation', 'basis', 'style'];
        
        function switchTab(tabId) {
            tabs.forEach(t => {
                const btn = document.getElementById(`nav-${t}`);
                const view = document.getElementById(`view-${t}`);
                
                if (t === tabId) {
                    btn.classList.add('active', 'border-blue-600', 'text-blue-600');
                    btn.classList.remove('border-transparent', 'text-slate-500');
                    view.classList.remove('hidden');
                } else {
                    btn.classList.remove('active', 'border-blue-600', 'text-blue-600');
                    btn.classList.add('border-transparent', 'text-slate-500');
                    view.classList.add('hidden');
                }
            });

            // Init charts if needed
            if (tabId === 'valuation' && !valuationChartInstance) {
                initValuationChart();
            }
        }

        // --- DDM Simulator Logic ---
        function updateDDM() {
            const g = parseFloat(document.getElementById('input-g').value);
            const r = parseFloat(document.getElementById('input-r').value);
            const erp = parseFloat(document.getElementById('input-erp').value);

            // Update UI Labels
            document.getElementById('val-g').innerText = g.toFixed(1) + "%";
            document.getElementById('val-r').innerText = r.toFixed(1) + "%";
            document.getElementById('val-erp').innerText = erp.toFixed(1) + "%";

            // Calculation: P = Base * (1+g) / (r + erp - g)
            // Note: This is a simplified "Fair Value Sensitivity" model, not absolute price
            // Assume Base EPS = 100 for simplicity
            
            const costOfEquity = r + erp;
            let fairValue = 0;
            let scenario = "";
            let pe = 0;

            // Avoid division by zero or negative denominator in perpetuity model
            // If (r + erp) <= g, price goes to infinity theoretically. We cap it.
            const denominator = costOfEquity - g;
            
            if (denominator <= 0.1) {
                fairValue = 10000; // Cap
                pe = 100;
                scenario = "æ³¡æ²«æå€¼ï¼šåœ¨æ­¤å‚æ•°ä¸‹ï¼Œä¼°å€¼è¶‹å‘æ— ç©·å¤§ã€‚";
            } else {
                fairValue = (100 * (1 + g/100)) / (denominator/100);
                pe = fairValue / 100;
                
                if (g > 8 && r < 3) scenario = "å®Œç¾é£æš´ï¼šé«˜å¢é•¿ + ä½åˆ©ç‡ï¼Œå¤§ç‰›å¸‚æ ¼å±€ã€‚";
                else if (g < 3 && r > 4) scenario = "æˆ´ç»´æ–¯åŒæ€ï¼šä½å¢é•¿ + é«˜åˆ©ç‡ï¼Œç†Šå¸‚æ ¼å±€ã€‚";
                else if (Math.abs(g - (r+erp)) < 2) scenario = "éœ‡è¡å¸‚ï¼šå¤šç©ºå› ç´ äº¤ç»‡ï¼Œå¸‚åœºå¯»æ‰¾æ–¹å‘ã€‚";
                else scenario = "ä¸­æ€§ç¯å¢ƒï¼šç›ˆåˆ©ä¸æµåŠ¨æ€§å¤„äºåˆç†åŒºé—´ã€‚";
            }

            // Animate Number (Simple)
            document.getElementById('result-price').innerText = Math.round(fairValue);
            document.getElementById('result-pe').innerText = pe.toFixed(1) + "x";
            document.getElementById('scenario-text').innerText = scenario;
        }

        // --- Basis Calculator Logic ---
        function calcBasis() {
            const spot = parseFloat(document.getElementById('calc-spot').value);
            const fut = parseFloat(document.getElementById('calc-fut').value);
            const days = parseFloat(document.getElementById('calc-days').value);

            const basis = spot - fut; // Basis = Spot - Fut
            const basisDisplay = basis.toFixed(2);
            
            // Annualized Yield = (Basis / Spot) * (365 / Days) * 100%
            // Note: Usually Future Discount Yield = (Spot - Fut) / Spot... or (Fut - Spot)/Spot.
            // If Futures < Spot (Discount/Backwardation), Buying Futures is cheaper.
            // Yield = (Spot - Futures) / Spot * (365/Days)
            
            let yieldVal = 0;
            if (spot > 0 && days > 0) {
                yieldVal = (basis / spot) * (365 / days) * 100;
            }

            const yieldElem = document.getElementById('res-basis-ann');
            const basisElem = document.getElementById('res-basis-abs');

            basisElem.innerText = (basis > 0 ? "+" : "") + basisDisplay;
            basisElem.className = basis > 0 ? "text-xl font-bold text-green-400" : "text-xl font-bold text-red-400";

            yieldElem.innerText = yieldVal.toFixed(2) + "%";
        }

        // --- Charts ---
        let valuationChartInstance = null;

        function initValuationChart() {
            const ctx = document.getElementById('valuationChart').getContext('2d');
            
            // Mock Data
            const labels = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            const priceData = [3800, 3750, 3600, 3900, 4000, 3950, 3850, 3700, 3650, 3500, 3600, 3700];
            const flowData = [50, -20, -50, 100, 80, 40, -10, -30, -10, -60, 20, 50]; // Net Flows

            valuationChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'åŒ—å‘èµ„é‡‘å‡€ä¹°å…¥ (äº¿å…ƒ) [å³è½´]',
                            data: flowData,
                            backgroundColor: (ctx) => {
                                const v = ctx.raw;
                                return v >= 0 ? 'rgba(34, 197, 94, 0.6)' : 'rgba(239, 68, 68, 0.6)';
                            },
                            yAxisID: 'y1',
                            order: 2
                        },
                        {
                            type: 'line',
                            label: 'æ²ªæ·±300æŒ‡æ•° [å·¦è½´]',
                            data: priceData,
                            borderColor: '#2563eb',
                            backgroundColor: 'rgba(37, 99, 235, 0.1)',
                            borderWidth: 2,
                            tension: 0.4,
                            yAxisID: 'y',
                            order: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: { mode: 'index', intersect: false },
                    scales: {
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: { display: true, text: 'æŒ‡æ•°ç‚¹ä½' }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            grid: { drawOnChartArea: false },
                            title: { display: true, text: 'èµ„é‡‘æµ (äº¿å…ƒ)' }
                        }
                    }
                }
            });
        }

        // Initialize DDM on load
        window.onload = function() {
            updateDDM();
            calcBasis();
        };

    </script>
</body>
</html>